<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Krishitantra SE-SLM ‚Äì Self-Evolving Small Language Model Dashboard">
    <title>Krishitantra ‚Äì SE-SLM Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>

    <!-- ========== Header ========== -->
    <header class="header">
        <div class="header-inner">
            <div class="logo">
                <div class="logo-icon">üß†</div>
                <span class="logo-text">Krishitantra</span>
                <span class="logo-badge">SE-SLM v3.0</span>
            </div>
            <div class="header-status">
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span id="header-model">Model: base</span>
                </div>
                <div class="status-indicator">
                    <span id="header-uptime">‚è± 0s</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ========== Nav Tabs ========== -->
    <main class="main-container">
        <nav class="nav-tabs" role="tablist">
            <button class="nav-tab active" data-tab="overview" role="tab">
                <span class="tab-icon">üìä</span> Overview
            </button>
            <button class="nav-tab" data-tab="inference" role="tab">
                <span class="tab-icon">üí¨</span> Chat
            </button>
            <button class="nav-tab" data-tab="telemetry" role="tab">
                <span class="tab-icon">üìà</span> Telemetry
            </button>
            <button class="nav-tab" data-tab="analysis" role="tab">
                <span class="tab-icon">üî¨</span> Analysis
            </button>
            <button class="nav-tab" data-tab="evolution" role="tab">
                <span class="tab-icon">üß¨</span> Evolution
            </button>
            <button class="nav-tab" data-tab="registry" role="tab">
                <span class="tab-icon">üìã</span> Registry
            </button>
            <button class="nav-tab" data-tab="drift" role="tab">
                <span class="tab-icon">üåä</span> Drift
            </button>
            <button class="nav-tab" data-tab="governance" role="tab">
                <span class="tab-icon">üõ°Ô∏è</span> Governance
            </button>
        </nav>

        <!-- ====================== -->
        <!-- OVERVIEW TAB -->
        <!-- ====================== -->
        <section id="tab-overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Requests</div>
                    <div class="stat-value" id="ov-requests">0</div>
                    <div class="stat-sub">Inference calls processed</div>
                    <div class="stat-icon">üì®</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Avg Latency</div>
                    <div class="stat-value" id="ov-latency">0<span style="font-size:0.9rem">ms</span></div>
                    <div class="stat-sub">Mean response time</div>
                    <div class="stat-icon">‚ö°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Model Version</div>
                    <div class="stat-value" id="ov-model" style="font-size:1.4rem">base</div>
                    <div class="stat-sub">Currently active</div>
                    <div class="stat-icon">üß†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Drift Events</div>
                    <div class="stat-value" id="ov-drifts">0</div>
                    <div class="stat-sub">Domain shifts detected</div>
                    <div class="stat-icon">üåä</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Tokens Processed</div>
                    <div class="stat-value" id="ov-tokens">0</div>
                    <div class="stat-sub">Input + output tokens</div>
                    <div class="stat-icon">üî§</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Evolutions</div>
                    <div class="stat-value" id="ov-evolutions">0</div>
                    <div class="stat-sub">Model versions created</div>
                    <div class="stat-icon">üß¨</div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üìà</span> Recent Activity</div>
                    </div>
                    <div id="ov-activity">
                        <div class="empty-state">
                            <div class="icon">üì≠</div>
                            <p>No activity yet. Send a message in Chat to begin.</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üè•</span> System Health</div>
                    </div>
                    <div id="ov-health">
                        <div class="progress-bar-container">
                            <div class="progress-label"><span>System Status</span><span
                                    id="ov-status-text">Healthy</span></div>
                            <div class="progress-bar">
                                <div class="progress-fill success" style="width:100%"></div>
                            </div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-label"><span>Uptime</span><span id="ov-uptime-text">0s</span></div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width:100%"></div>
                            </div>
                        </div>
                        <div style="margin-top:1rem;font-size:0.8rem;color:var(--text-muted)">
                            <p>Latency range: <span id="ov-lat-range">N/A</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- INFERENCE / CHAT TAB (WhatsApp Style) -->
        <!-- ====================== -->
        <section id="tab-inference" class="tab-content">
            <div class="wa-app-wrapper">
                <!-- Main Chat Area -->
                <div class="wa-chat-area">
                    <!-- Chat Header -->
                    <div class="wa-header">
                        <div class="wa-avatar">üß†</div>
                        <div class="wa-chat-info">
                            <div class="wa-chat-name">Krishitantra AI</div>
                            <div class="wa-chat-status" id="wa-status">Online ‚Ä¢ SE-SLM v3.0</div>
                        </div>
                        <div class="wa-header-icons">
                            <button class="wa-icon-btn" title="Menu" onclick="clearChat()"><svg viewBox="0 0 24 24"
                                    width="24" height="24">
                                    <path fill="currentColor"
                                        d="M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z">
                                    </path>
                                </svg></button>
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="wa-chat-body" id="wa-chat-body">
                        <div class="wa-encryption-msg">
                            <span class="lock-icon">üîí</span> Messages are processed locally by the SE-SLM model.
                            End-to-end secure.
                        </div>
                        <div class="wa-date-divider"><span>Today</span></div>
                        <div class="wa-message wa-incoming">
                            <div class="wa-bubble">
                                <div class="wa-text">Hello! I'm <strong>Krishitantra AI</strong>. How can I help you
                                    today?</div>
                                <div class="wa-meta">
                                    <span class="wa-time" id="wa-welcome-time">--:--</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input Footer -->
                    <div class="wa-chat-footer">
                        <button class="wa-icon-btn" title="Emoji">
                            <svg viewBox="0 0 24 24" width="24" height="24">
                                <path fill="currentColor"
                                    d="M9.153 11.603c.795 0 1.439-.879 1.439-1.962s-.644-1.962-1.439-1.962-1.439.879-1.439 1.962.644 1.962 1.439 1.962zm-3.204 1.362c-.026-.307-.131 5.218 6.063 5.551 6.066-.25 6.066-5.551 6.066-5.551-6.078 1.416-12.129 0-12.129 0zm11.363 1.108s-.669 1.959-5.051 1.959c-3.505 0-5.388-1.164-5.607-1.959 0 0 5.912 1.055 10.658 0zM11.804 1.011C5.609 1.011.978 6.033.978 12.228s4.826 10.761 11.021 10.761S23.02 18.423 23.02 12.228c.001-6.195-5.021-11.217-11.216-11.217zM12 21.354c-5.273 0-9.381-3.886-9.381-9.159s3.942-9.548 9.215-9.548 9.548 4.275 9.548 9.548c-.001 5.272-4.109 9.159-9.382 9.159zm3.108-9.751c.795 0 1.439-.879 1.439-1.962s-.644-1.962-1.439-1.962-1.439.879-1.439 1.962.644 1.962 1.439 1.962z">
                                </path>
                            </svg>
                        </button>
                        <button class="wa-icon-btn" title="Attach">
                            <svg viewBox="0 0 24 24" width="24" height="24">
                                <path fill="currentColor"
                                    d="M1.816 15.556v.002c0 1.502.584 2.912 1.646 3.972s2.472 1.646 3.974 1.646a5.58 5.58 0 0 0 3.972-1.646l8.846-8.844a4.611 4.611 0 0 0 1.647-3.977 4.597 4.597 0 0 0-1.647-3.977 4.613 4.613 0 0 0-3.975-1.646c-1.503 0-2.912.583-3.974 1.645L4.47 10.569a.498.498 0 0 0-.147.354c0 .133.054.261.147.354l.001.001a.5.5 0 0 0 .708 0l7.835-7.835c.801-.8 1.861-1.239 2.986-1.239 1.126 0 2.185.439 2.987 1.239a4.246 4.246 0 0 1 0 5.998l-8.845 8.844a4.577 4.577 0 0 1-3.266 1.354 4.58 4.58 0 0 1-3.265-1.354 4.609 4.609 0 0 1-1.354-3.268c0-1.226.478-2.378 1.353-3.268l8.362-8.36a.499.499 0 0 0 0-.707l-.001-.002a.498.498 0 0 0-.707 0l-8.363 8.361a5.61 5.61 0 0 0-1.646 3.977z">
                                </path>
                            </svg>
                        </button>
                        <div class="wa-input-container">
                            <input type="text" class="wa-input" id="wa-input" placeholder="Type a message"
                                autocomplete="off" />
                        </div>
                        <button class="wa-icon-btn" title="Voice Message" id="wa-mic-btn" onclick="sendMessage()">
                            <svg viewBox="0 0 24 24" width="24" height="24" id="wa-mic-icon">
                                <path fill="currentColor"
                                    d="M11.999 14.942c2.001 0 3.531-1.53 3.531-3.531V4.35c0-2.001-1.53-3.531-3.531-3.531S8.469 2.35 8.469 4.35v7.061c0 2.001 1.53 3.531 3.53 3.531zm4.338-3.531a.5.5 0 0 1 .5.5c0 2.597-2.107 4.711-4.704 4.711-2.595 0-4.703-2.114-4.703-4.711a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5c0 2.036 1.666 3.711 3.703 3.711 2.037 0 3.704-1.675 3.704-3.711a.5.5 0 0 1 .5-.5zm-4.838 6.417c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-1.159c1.076-.118 2.062-.519 2.87-1.115a.5.5 0 0 1 .586.808c-.974.708-2.161 1.157-3.456 1.258v.208z">
                                </path>
                            </svg>
                            <svg viewBox="0 0 24 24" width="24" height="24" id="wa-send-icon" style="display:none">
                                <path fill="currentColor"
                                    d="M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.239 1.816-13.239 1.817-.011 7.912z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- TELEMETRY TAB -->
        <!-- ====================== -->
        <section id="tab-telemetry" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Requests</div>
                    <div class="stat-value" id="tel-total">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Avg Latency</div>
                    <div class="stat-value" id="tel-avg-lat">0<span style="font-size:0.9rem">ms</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Min Latency</div>
                    <div class="stat-value" id="tel-min-lat">0<span style="font-size:0.9rem">ms</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Max Latency</div>
                    <div class="stat-value" id="tel-max-lat">0<span style="font-size:0.9rem">ms</span></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üìä</span> Latency Distribution</div>
                    <button class="card-action" onclick="loadTelemetry()">Refresh</button>
                </div>
                <div id="tel-latency-chart"
                    style="display:flex;align-items:flex-end;gap:3px;height:150px;padding:1rem 0"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üîß</span> Structural Telemetry</div>
                </div>
                <div id="tel-structural" class="json-view">Loading structural telemetry...</div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- ANALYSIS TAB -->
        <!-- ====================== -->
        <section id="tab-analysis" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üî¨</span> Structural Analysis</div>
                    <button class="card-action" id="analysis-btn" onclick="runAnalysis()">Run Analysis</button>
                </div>
                <div id="analysis-result">
                    <div class="empty-state">
                        <div class="icon">üî¨</div>
                        <p>Click "Run Analysis" to analyze model structure based on telemetry data.</p>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">‚úÇÔ∏è</span> Prunable Blocks</div>
                    </div>
                    <div id="analysis-prunable">
                        <div class="empty-state">
                            <p>Run analysis first</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üí°</span> Recommendations</div>
                    </div>
                    <div id="analysis-recs">
                        <div class="empty-state">
                            <p>Run analysis first</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- EVOLUTION TAB -->
        <!-- ====================== -->
        <section id="tab-evolution" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üß¨</span> Evolution Engine</div>
                    <button class="btn-primary" id="evolve-btn" onclick="triggerEvolution()">
                        üöÄ Trigger Evolution
                    </button>
                </div>
                <p style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:1rem">
                    Manually trigger an evolution cycle: collect telemetry ‚Üí generate candidates ‚Üí recompile ‚Üí validate
                    ‚Üí deploy.
                </p>
                <div id="evolution-status"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üìú</span> Evolution History</div>
                </div>
                <div id="evolution-history">
                    <div class="empty-state">
                        <div class="icon">üß¨</div>
                        <p>No evolution cycles recorded yet.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üìä</span> Profiling Report</div>
                    <button class="card-action" onclick="runProfiler()">Generate Report</button>
                </div>
                <div id="profiler-result" class="json-view">Click "Generate Report" to create usage profiling report.
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- REGISTRY TAB -->
        <!-- ====================== -->
        <section id="tab-registry" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><span class="icon">üìã</span> Model Registry</div>
                    <button class="card-action" onclick="loadRegistry()">Refresh</button>
                </div>
                <div id="registry-summary" style="margin-bottom:1rem"></div>
                <div style="overflow-x:auto">
                    <table class="data-table" id="registry-table">
                        <thead>
                            <tr>
                                <th>Version</th>
                                <th>Parent</th>
                                <th>Optimization</th>
                                <th>Compression</th>
                                <th>Accuracy Drop</th>
                                <th>Validation</th>
                                <th>Timestamp</th>
                            </tr>
                        </thead>
                        <tbody id="registry-body"></tbody>
                    </table>
                </div>
                <div id="registry-empty" class="empty-state">
                    <div class="icon">üìã</div>
                    <p>No models registered yet. Trigger an evolution to create optimized versions.</p>
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- DRIFT TAB -->
        <!-- ====================== -->
        <section id="tab-drift" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üåä</span> Drift Detection</div>
                        <button class="card-action" onclick="loadDrift()">Refresh</button>
                    </div>
                    <div class="drift-score-display">
                        <div class="drift-circle low" id="drift-circle">
                            <div class="drift-value" id="drift-current-score">0.00</div>
                            <div class="drift-label">Drift Score</div>
                        </div>
                        <div style="display:flex;justify-content:center;gap:2rem;margin-top:1rem">
                            <div>
                                <div style="font-size:0.7rem;color:var(--text-muted)">MEMORY SIZE</div>
                                <div style="font-size:1.1rem;font-weight:600" id="drift-mem-size">0</div>
                            </div>
                            <div>
                                <div style="font-size:0.7rem;color:var(--text-muted)">DRIFT EVENTS</div>
                                <div style="font-size:1.1rem;font-weight:600" id="drift-events-count">0</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üìâ</span> Drift History</div>
                    </div>
                    <div id="drift-chart"
                        style="display:flex;align-items:flex-end;gap:3px;height:120px;padding:0.5rem 0"></div>
                    <div style="overflow-x:auto;margin-top:1rem">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Score</th>
                                    <th>Flag</th>
                                    <th>Embedding</th>
                                    <th>Vocab</th>
                                    <th>Timestamp</th>
                                </tr>
                            </thead>
                            <tbody id="drift-history-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ====================== -->
        <!-- GOVERNANCE TAB -->
        <!-- ====================== -->
        <section id="tab-governance" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üõ°Ô∏è</span> Governance Controls</div>
                    </div>
                    <div id="gov-summary" style="margin-bottom:1.25rem"></div>
                    <div style="display:flex;gap:10px;flex-wrap:wrap">
                        <button class="btn-danger" onclick="performRollback()">
                            ‚è™ Rollback to Backup
                        </button>
                        <button class="card-action" onclick="loadGovernance()">
                            üîÑ Refresh
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><span class="icon">üìú</span> Audit Trail</div>
                    </div>
                    <div id="gov-audit">
                        <div class="empty-state">
                            <div class="icon">üìú</div>
                            <p>No audit events recorded yet.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script src="/static/app.js"></script>
</body>

</html>